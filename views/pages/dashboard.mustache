<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{#pageTitle}}{{pageTitle}} - {{/pageTitle}}CodePath</title>
    
    <!-- CSS Global -->
    <link rel="stylesheet" href="/css/global.css">
    <link rel="stylesheet" href="/css/responsive.css">
    
    <!-- CSS Específico da Página -->
    {{#additionalCSS}}
        <link rel="stylesheet" href="/css/{{additionalCSS}}.css">
    {{/additionalCSS}}
    
    <!-- Fontes -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Ícones -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
</head>
<body class="{{bodyClass}}">
    <div class="app-container">
        <!-- Sidebar -->
        {{>partials/sidebar}}
        
        <!-- Main Content Area -->
        <div class="main-content">
            <!-- Header/Topbar -->
            {{>partials/header}}
            
            <!-- Page Content -->
            <main class="content-area" role="main">
                <!-- Welcome Section -->
                <div class="welcome-section">
                    <div class="welcome-header">
                        <h1 class="welcome-title">Bem-vindo de volta, {{user.name}}!</h1>
                        <p class="welcome-subtitle">Continue sua jornada de aprendizado</p>
                    </div>
                    
                    <!-- User Progress Overview -->
                    <div class="progress-overview">
                        <div class="progress-stats">
                            <div class="stat-item">
                                <span class="stat-label">Nível Atual</span>
                                <span class="stat-value">{{user.level}}</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">XP Total</span>
                                <span class="stat-value">{{user.xp_points}}</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">Sequência</span>
                                <span class="stat-value">{{user.streak_days}} dias</span>
                            </div>
                        </div>
                        
                        <!-- Level Progress Bar -->
                        <div class="level-progress">
                            <div class="progress-info">
                                <span class="progress-label">Progresso para o próximo nível</span>
                                <span class="progress-percentage">{{levelProgress}}%</span>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: {{levelProgress}}%"></div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Metrics Cards -->
                <div class="metrics-section">
                    <h2 class="section-title">Suas Estatísticas</h2>
                    <div class="metrics-grid">
                        <div class="metric-card">
                            <div class="metric-icon">
                                <i class="fas fa-play-circle"></i>
                            </div>
                            <div class="metric-content">
                                <h3 class="metric-title">Aulas Assistidas</h3>
                                <p class="metric-value">{{metrics.lessonsWatched}}</p>
                                <span class="metric-change positive">+{{metrics.lessonsThisWeek}} esta semana</span>
                            </div>
                        </div>
                        
                        <div class="metric-card">
                            <div class="metric-icon">
                                <i class="fas fa-certificate"></i>
                            </div>
                            <div class="metric-content">
                                <h3 class="metric-title">Cursos Concluídos</h3>
                                <p class="metric-value">{{metrics.coursesCompleted}}</p>
                                <span class="metric-change positive">+{{metrics.coursesThisMonth}} este mês</span>
                            </div>
                        </div>
                        
                        <div class="metric-card">
                            <div class="metric-icon">
                                <i class="fas fa-code"></i>
                            </div>
                            <div class="metric-content">
                                <h3 class="metric-title">Desafios Entregues</h3>
                                <p class="metric-value">{{metrics.challengesCompleted}}</p>
                                <span class="metric-change neutral">{{metrics.challengesPending}} pendentes</span>
                            </div>
                        </div>
                        
                        <div class="metric-card">
                            <div class="metric-icon">
                                <i class="fas fa-question-circle"></i>
                            </div>
                            <div class="metric-content">
                                <h3 class="metric-title">Questionários Realizados</h3>
                                <p class="metric-value">{{metrics.quizzesCompleted}}</p>
                                <span class="metric-change positive">{{metrics.averageScore}}% média</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Continue Studying Section -->
                <div class="continue-section">
                    <h2 class="section-title">Continue Estudando</h2>
                    
                    {{#currentPackages}}
                    <div class="continue-grid">
                        {{#packages}}
                        <div class="package-card">
                            <div class="package-header">
                                <div class="package-icon">
                                    <i class="{{icon}}"></i>
                                </div>
                                <div class="package-info">
                                    <h3 class="package-name">{{name}}</h3>
                                    <p class="package-lesson">{{currentLesson}}</p>
                                </div>
                            </div>
                            
                            <div class="package-progress">
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: {{progressPercentage}}%"></div>
                                </div>
                                <span class="progress-text">{{progressPercentage}}% concluído</span>
                            </div>
                            
                            <div class="package-actions">
                                <a href="/content/package/{{id}}/lessons" class="btn btn-primary">
                                    <i class="fas fa-play"></i>
                                    Continuar
                                </a>
                                <button class="btn btn-secondary" onclick="showProgressModal('{{id}}')">
                                    <i class="fas fa-chart-line"></i>
                                    Ver Progresso
                                </button>
                            </div>
                        </div>
                        {{/packages}}
                    </div>
                    {{/currentPackages}}
                    
                    {{^currentPackages}}
                    <div class="empty-state">
                        <div class="empty-icon">
                            <i class="fas fa-book-open"></i>
                        </div>
                        <h3>Comece sua jornada!</h3>
                        <p>Escolha um pacote de tecnologia para começar a estudar.</p>
                        <a href="/careers" class="btn btn-primary">
                            <i class="fas fa-road"></i>
                            Explorar Carreiras
                        </a>
                    </div>
                    {{/currentPackages}}
                </div>
                
                <!-- Recent Activity -->
                <div class="activity-section">
                    <h2 class="section-title">Atividade Recente</h2>
                    
                    {{#recentActivity}}
                    <div class="activity-list">
                        {{#activities}}
                        <div class="activity-item">
                            <div class="activity-icon {{type}}">
                                <i class="{{icon}}"></i>
                            </div>
                            <div class="activity-content">
                                <p class="activity-text">{{description}}</p>
                                <span class="activity-time">{{timeAgo}}</span>
                            </div>
                            {{#points}}
                            <div class="activity-points">
                                +{{points}} XP
                            </div>
                            {{/points}}
                        </div>
                        {{/activities}}
                    </div>
                    {{/recentActivity}}
                    
                    {{^recentActivity}}
                    <div class="empty-activity">
                        <p>Nenhuma atividade recente. Comece a estudar para ver seu progresso aqui!</p>
                    </div>
                    {{/recentActivity}}
                </div>
                
                <!-- Quick Actions -->
                <div class="quick-actions">
                    <h2 class="section-title">Ações Rápidas</h2>
                    <div class="actions-grid">
                        <a href="/careers" class="action-card">
                            <div class="action-icon">
                                <i class="fas fa-road"></i>
                            </div>
                            <div class="action-content">
                                <h3>Explorar Carreiras</h3>
                                <p>Descubra novos caminhos na tecnologia</p>
                            </div>
                        </a>
                        
                        <a href="/profile" class="action-card">
                            <div class="action-icon">
                                <i class="fas fa-user"></i>
                            </div>
                            <div class="action-content">
                                <h3>Meu Perfil</h3>
                                <p>Gerencie suas informações pessoais</p>
                            </div>
                        </a>
                        
                        <a href="/performance" class="action-card">
                            <div class="action-icon">
                                <i class="fas fa-chart-line"></i>
                            </div>
                            <div class="action-content">
                                <h3>Desempenho</h3>
                                <p>Veja estatísticas detalhadas</p>
                            </div>
                        </a>
                        
                        <a href="/settings" class="action-card">
                            <div class="action-icon">
                                <i class="fas fa-cog"></i>
                            </div>
                            <div class="action-content">
                                <h3>Configurações</h3>
                                <p>Personalize sua experiência</p>
                            </div>
                        </a>
                    </div>
                </div>
            </main>
            
            <!-- Footer -->
            {{>partials/footer}}
        </div>
    </div>
    
    <!-- Overlay para mobile -->
    <div class="sidebar-overlay" id="sidebarOverlay"></div>
    
    <!-- Progress Modal -->
    <div id="progressModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Progresso do Pacote</h3>
                <button class="modal-close" onclick="closeProgressModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <!-- Conteúdo será carregado dinamicamente -->
            </div>
        </div>
    </div>
    
    <!-- JavaScript Global -->
    <script src="/js/main.js"></script>
    
    <!-- JavaScript Específico da Página -->
    {{#additionalJS}}
        <script src="/js/{{additionalJS}}.js"></script>
    {{/additionalJS}}
    
    <script>
    // JavaScript para funcionalidades do dashboard
    document.addEventListener('DOMContentLoaded', function() {
        // Função para mostrar modal de progresso
        window.showProgressModal = function(packageId) {
            const modal = document.getElementById('progressModal');
            modal.style.display = 'flex';
            
            const modalBody = modal.querySelector('.modal-body');
            modalBody.innerHTML = `
                <div class="loading">
                    <i class="fas fa-spinner fa-spin"></i>
                    <p>Carregando dados do progresso...</p>
                </div>
            `;
            
            // Simular carregamento
            setTimeout(() => {
                modalBody.innerHTML = `
                    <div class="progress-details">
                        <p>Funcionalidade será implementada na próxima fase!</p>
                        <p>Pacote ID: ${packageId}</p>
                    </div>
                `;
            }, 1000);
        };
        
        // Função para fechar modal
        window.closeProgressModal = function() {
            const modal = document.getElementById('progressModal');
            modal.style.display = 'none';
        };
        
        // Fechar modal ao clicar fora
        window.addEventListener('click', function(event) {
            const modal = document.getElementById('progressModal');
            if (event.target === modal) {
                closeProgressModal();
            }
        });
    });
    </script>
</body>
</html>
